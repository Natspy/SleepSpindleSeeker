# -*- coding: utf-8 -*-
"""AS_PROJEKT_2_Natalia_Karczewska

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1L6oH9EuCOZzrsu6lU013tEiS4INt1Tix

#Projekt 2 - Wyszukiwanie wrzecion snu - Natalia Karczewska

## Wstęp
W naturalnym śnie zdrowego człowieka występuje około czterech cykli pogłębiania się i spłycania snu. W każdym cyklu, zapisach EEG ze snu, wyróżnia się tzw. stadia snu odpowiadające różnej jego głębokości. W szczególności stadium II charakteryzuje się występowaniem tzw. wrzecion snu, czyli widocznych w zapisie struktur o częstości 11-16Hz i trwających powyżej 0,5 s.

## Dane
* Pobieram [sygnał](https://drive.google.com/open?id=0BzwQ_Lscn8yDem5NMlp3cncyd0k), będący fragmentem (600 s) sygnału EEG ze stadium II snu.
* Importuję niezbędne biblioteki.
* Następnie otwieram pobrany sygnał i wyświetlam go na wykresie poniżej, aby obejrzeć jego przebieg - wybrałam pierwsze 10 sekund, aby przyjrzeć się im dokładniej.
"""

import numpy as np
import matplotlib.pyplot as plt
import more_itertools as mit
from  scipy.signal import freqz, group_delay
from  scipy.signal import butter, buttord 
from  scipy.signal import cheby2, cheb2ord   
from  scipy.signal import lfilter, filtfilt

with open('inb14_fragment.bin', 'rb') as f_out:
    syg = np.fromfile(f_out, dtype='float32')

Fs = 128
dt = 1/Fs
T = len(syg)/Fs
t = np.arange(0,T,dt)
plt.plot(t[:10*Fs],syg[:10*Fs], color='purple')
plt.title('Przebieg pobranego sygnału')
plt.xlabel('Czas [s]')
plt.show()

"""---

## Pierwszy klasyfikator - filtry:
* do filtracji wybrałam filtr Butterworth'a rzędu 3.
* filtruję sygnał filtrem pasmowo-przepustowym w paśmie 11-16 Hz.
* przefiltrowany sygnał podnoszę do kwadratu i filtruję go ponownie filtrem dolnoprzepustowym z częstością odcięcia 10 Hz.
* pierwiastkuję uzyskany sygnał, aby 'odwrócić' wcześniejsze podnoszenie do kwadratu.
"""

# filtr pasmowo-przepustowy:
[b,a]=butter(3,(11,16), btype='bandpass', fs=Fs)
sf = filtfilt(b,a,syg)**2

# filtr dolnoprzepustowy
[d,c] = butter(3,10, btype='lowpass', fs=Fs)
sf2 = np.sqrt(filtfilt(d,c,sf))

"""* wyszukuję momenty, w których sygnał przekracza wartość 5µV na okresy dłuższe niż 0,5 s.
* znalezione momenty to poszukiwane wrzeciona snu.
"""

# tworzę funkcję korzystającą z biblioteki intertools, która zwraca tablicę z indeksami wrzecion
def FindSequence(syg, n): #n - długość sekwencji
  syg = list(syg)
  indexes = [syg.index(i) for i in syg if i > 5]
  temp = [list(group) for group in mit.consecutive_groups(indexes)]
  result =  [group for group in temp if len(group) > n]
  return result
 
wrzeciona = FindSequence(sf2, 64)
print("Liczba wykrytych wrzecion:",len(wrzeciona))
 
plt.figure(figsize=(10,6), dpi= 100, facecolor='w', edgecolor='k')
plt.plot(t,sf2, color ='cornflowerblue')
for i in wrzeciona:
    plt.plot(t[i],sf2[i],"r-")
plt.title('Przefiltrowany sygnał z wrzecionami zaznaczonymi kolorem czerwonym')
plt.xlabel('Czas [s]')
plt.grid(True)
plt.show()

"""W zależności od rodzaju i rzędu filtra, liczba wykrytych wrzecion może ulegać niewielkim zmianom - dla filtra Butterwortha rzędu 2 w przefiltrowanym sygnale można wyróżnić 18 wrzecion, a dla filtra 8 rzędu - 22 wrzeciona. Wybrałam filtr 3 rzędu, ponieważ prezentuje on wynik pośredni. Jego własności umieszczę w podsumowaniu.

Poniżej prezentuję pierwsze 10 sekund przefiltrowanego sygnału. Jak widać w przybliżeniu, powstała wyraźna obwiednia sygnału, na której zaznaczono kolorem czerwonym pierwsze wykryte w sygnale wrzeciono snu - pomiędzy 9 a 10 sekundą.
"""

plt.plot(t[:10*Fs],sf2[:10*Fs], color ='cornflowerblue')
plt.plot(t[wrzeciona[0]],sf2[wrzeciona[0]],"r-")
plt.xlabel("Czas [s]")
plt.ylabel("Napięcie [µV]")
plt.grid(True)
plt.show()

"""Zgodnie z oczekiwaniami - w zaznaczonym miejscu widzimy gołym okiem, że sygnał w tym obszarze przekracza 5µV przez ponad pół sekundy. Przypomnijmy wygląd pierwszych 10 sekund pierwotnego sygnału:

![indeks.png](data:image/png;base64,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)

Faktycznie, pomiędzy 9 a 10 sekundą można dostrzec gęściej oscylującą strukturę - jest to dosyć charakterystyczny wygląd wrzeciona snu.

---

## Drugi klasyfikator - algorytm MP:
* Przygotowywuję sygnał do dekompozycji MP;
"""

PlikSygnalu = 'inb14_fragment.dat'
a1 = np.array(syg,'float32')
f = open(PlikSygnalu,'wb')
a1.tofile(f)
f.close()

"""* Następnie wykonuję dekompozycję sygnału podzielonego na 30 epok po 20 sekund w programie [SVAROG](http://www.svarog.pl/);
* Ustawiam 50 iteracji na epokę oraz Energy Error = 0.1;
* Zamieszczam niezbędne funkcje, potrzebne do wykreślenia mapy czas-częstość.
"""

def TFRPlot(TFR, t_mapy, f_mapy, sig, Fs=128,title =''):
    df = f_mapy[1]-f_mapy[0]
    dt = t_mapy[1]-t_mapy[0]
    t = np.arange(0,len(sig))/Fs
    sygAxes = plt.axes([0.05, 0.05, 0.8, 0.1])
    tfAxes = plt.axes([0.05, 0.15, 0.8, 0.8])
    sygAxes.plot(t,sig)
    plt.xlim((t_mapy.min(), t_mapy.max()))
    tfAxes.imshow(TFR,aspect='auto',origin='lower',interpolation='nearest', 
                  extent=(t_mapy.min()-dt/2,t_mapy.max()+dt/2,f_mapy.min()-df/2,f_mapy.max()+df/2))
    plt.setp(tfAxes,xticklabels=[])
    plt.title(title)
    plt.ylabel('Częstość [Hz]')
    plt.show()

def gabor_db(t, s, t0, f0, phase=0.0):
    return np.exp(-np.pi*((t-t0)/s)**2) \
        * np.cos(2*np.pi*f0*(t-t0) + phase)

def fetch_metadata(book, name):
    return book.execute(
        'SELECT value FROM metadata WHERE param=?',
        [name]
    ).fetchone()[0]

def fetch_sample_count(book, segment_id):
    return book.execute(
        'SELECT sample_count FROM segments WHERE segment_id=?',
        [segment_id]
    ).fetchone()[0]

def fetch_original_signal(book, segment_id, channel_id):
    blob = book.execute(
        'SELECT samples_float32 FROM samples WHERE segment_id=? AND channel_id=?',
        [segment_id, channel_id]
    ).fetchone()[0]
    return np.frombuffer(blob, np.dtype('float32').newbyteorder('>'))

def query_for_atoms(book, segment_id, channel_id):
    book.execute(
        'SELECT * FROM atoms WHERE segment_id=? AND channel_id=? ORDER BY iteration',
        [segment_id, channel_id]
    )

"""* Wczytuję książkę (zbiór atomów, na które rozłożono sygnał) oraz definiuję potrzebne zmienne;

"""

import sqlite3
book = sqlite3.connect('book_e01.db').cursor()
book.row_factory = sqlite3.Row

sampling_frequency = float(fetch_metadata(book, 'sampling_frequency_Hz'))
sample_count = fetch_sample_count(book, segment_id = 0)

N = int(sampling_frequency)
f = np.linspace(0, sampling_frequency/2, N)
rec_t = np.zeros((1,sample_count))
rec_f = np.zeros((int(sampling_frequency),1))
t = np.arange(sample_count) / sampling_frequency

"""* Wykonuję mapy czas-częstość z pominięciem atomów, które nie spełniają definicji wrzeciona"""

liczba_wrzecion = 0
for s in range(30):
  rekonstrukcja = np.zeros(sample_count) # tablica na rekonstrukcję
  mapaEnergii = np.zeros((N, sample_count)) # tablica na reprezentację czas-częstość
  query_for_atoms(book, segment_id=s, channel_id=0)
  for atom in book:
    A = atom['amplitude']
    energia = atom['energy']
    f_Hz = atom['f_Hz']
    faza = atom['phase']
    skala = atom['scale_s']
    t0 = atom['t0_s']
    t0_abs = atom['t0_abs_s']
    rec_t[0,:] = np.exp(-np.pi*((t-t0)/skala)**2)   # obliczam obwiednię czasową
    rec_f[:,0] = np.exp(-np.pi*((f-f_Hz)*skala)**2) # obliczam obwiednię częstotliwościową
    tfr_atom = np.kron(rec_t,rec_f) # reprezentacja czas-częstość pojedynczego atomu
    tfr_atom/= np.sum(np.sum(tfr_atom))  # normalizacja
    tfr_atom *= energia # skalowanie energii
    if f_Hz>11 and f_Hz<16 and skala>0.5 and A>5: # wyszukuję wrzeciona
      liczba_wrzecion += 1
      mapaEnergii += tfr_atom
      gab =  A * np.exp(-np.pi*((t-t0)/skala)**2)*np.cos(2*np.pi*f_Hz*(t-t0)+faza)
      rekonstrukcja += gab
  if np.sum(rekonstrukcja) != 0:
    TFRPlot(mapaEnergii,t,f,rekonstrukcja,Fs=Fs,title=f'Energy Error: 0.1\nczas:{20*s}-{20*(s+1)}s, epoka:{s + 1}')
plt.show()
print("Liczba wykrytych wrzecion:",liczba_wrzecion)

"""Za pomocą drugiego klasyfikatora i dekompozycji MP z parametrem Energy Error = 0.1, wykryłam w sygnale 14 wrzecion. Wykryte wrzeciona w ogólnym porównaniu znajdują się (z drobnymi wyjątkami) w tych samych miejscach, w których zostały one wykryte przez filtr. Poniżej prezentuję wyniki ponownie wykonanej dekompozycji, tym razem z parametrem Energy Error = 0,01."""

import sqlite3
book = sqlite3.connect('book_e001.db').cursor()
book.row_factory = sqlite3.Row

sampling_frequency = float(fetch_metadata(book, 'sampling_frequency_Hz'))
sample_count = fetch_sample_count(book, segment_id = 0)

N = int(sampling_frequency)
f = np.linspace(0, sampling_frequency/2, N)
rec_t = np.zeros((1,sample_count))
rec_f = np.zeros((int(sampling_frequency),1))
t = np.arange(sample_count) / sampling_frequency

liczba_wrzecion = 0
for s in range(30):
  rekonstrukcja = np.zeros(sample_count) # tablica na rekonstrukcję
  mapaEnergii = np.zeros((N, sample_count)) # tablica na reprezentację czas-częstość
  query_for_atoms(book, segment_id=s, channel_id=0)
  for atom in book:
    A = atom['amplitude']
    energia = atom['energy']
    f_Hz = atom['f_Hz']
    faza = atom['phase']
    skala = atom['scale_s']
    t0 = atom['t0_s']
    t0_abs = atom['t0_abs_s']
    rec_t[0,:] = np.exp(-np.pi*((t-t0)/skala)**2)   # obliczam obwiednię czasową
    rec_f[:,0] = np.exp(-np.pi*((f-f_Hz)*skala)**2) # obliczam obwiednię częstotliwościową
    tfr_atom = np.kron(rec_t,rec_f) # reprezentacja czas-częstość pojedynczego atomu
    tfr_atom/= np.sum(np.sum(tfr_atom))  # normalizacja
    tfr_atom *= energia # skalowanie energii
    if f_Hz>11 and f_Hz<16 and skala>0.5 and A>5: # wyszukuję wrzeciona
      liczba_wrzecion += 1
      mapaEnergii += tfr_atom
      gab =  A * np.exp(-np.pi*((t-t0)/skala)**2)*np.cos(2*np.pi*f_Hz*(t-t0)+faza)
      rekonstrukcja += gab
  if np.sum(rekonstrukcja) != 0:
    TFRPlot(mapaEnergii,t,f,rekonstrukcja,Fs=Fs,title=f'Energy Error: 0.01\nczas:{20*s}-{20*(s+1)}s, epoka:{s + 1}')
plt.show()
print("Liczba wykrytych wrzecion:",liczba_wrzecion)

"""## Podsumowanie i wnioski
---
Poniżej prezentuję porównanie dla obu klasyfikatorów na przykładzie trzech wrzecion wykrytych w sygnale pomiędzy 350 a 360 sekundą zestawione z oryginalnym sygnałem.
"""

T = len(syg)/Fs
t = np.arange(0,T,dt)

plt.subplot(2,1,1)
plt.plot(t[340*Fs:360*Fs],sf2[340*Fs:360*Fs], color ='cornflowerblue')
for i in range(8,11):
  plt.plot(t[wrzeciona[i]],sf2[wrzeciona[i]],"r-")
plt.xlabel("Czas [s]")
plt.ylabel("Napięcie [µV]")
plt.grid(True)
plt.show()

plt.subplot(2,1,2)
plt.plot(t[350*Fs:360*Fs],syg[350*Fs:360*Fs], color='purple')
plt.title('Przebieg oryginalnego sygnału')
plt.xlabel('Czas [s]')
plt.show()

"""![Zrzut ekranu (1479).png](data:image/png;base64,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)

Pierwszy z klasyfikatorów wykrył około 20 wrzecion, natomiast drugi klasyfikator w zależności od parametru Energy Error(0.1) - 14 wrzecion oraz Energy Error(0.01) - 19 wrzecion. Obserwujemy zatem, że klasyfikatory wykazują dużą zgodność dla Energy Error = 0.01, oraz niższą zgodność dla Energy Error = 0.1. Wynika to z faktu, że algorytm MP jest procedurą iteracyjną, w której z szerokiego grona funkcji wybierane są reprezentacje najlepiej dopasowane do sygnału. Na to, jak szeroki zbiór funkcji zastosuje algorytm, wpływa wartość Energy Error - im ta wartość jest niższa, tym większy słownik (zbiór atomów użytych do dekompozycji). Większy słownik daje większe szanse na lepiej dopasowane reprezentacje, dlatego z większą dokładnością odnajdowane są wrzeciona.

Poniżej prezentuję własności zastosowanych filtrów za pomocą funkcji rysującej jego charakterystyki.
"""

def charkterystyki(a,b,f,T,Fs, f_lim = None):
    if f_lim == None:
      f_lim = (0, Fs/2)
    t = np.arange(-T, T, 1/Fs)
    f, h = freqz(b,a,f,fs = Fs) 
    m = np.abs(h) 
    faza = np.unwrap(np.angle(h))
    w = 2*np.pi*f/Fs 
  
    ff, grupowe = group_delay((b, a), f,fs=Fs)
    
    x = np.zeros(len(t))
    x[len(t)//2] = 1
    y = lfilter(b,a,x)
    
    s = np.zeros(len(t))
    s[len(t)//2:] = 1 
    ys = lfilter(b,a,s)
    
    fig = plt.figure()
    plt.subplot(2,2,1)
    plt.title('moduł transmitancji')
    M = 20*np.log10(m)
    plt.plot(f,M)
    plt.ylabel('[dB]')
    plt.grid('on')
    plt.xlim(f_lim)
    M_zoom = M[np.logical_and( f_lim[0]<f , f<f_lim[1])]
    plt.ylim((np.min(M_zoom), np.max(M_zoom)))
    
    plt.subplot(2,2,3)
    plt.title('opóźnienie grupowe')
    plt.plot(f,grupowe)
    plt.ylabel('probki')
    plt.xlabel('Częstość [Hz]')
    plt.grid('on')
    plt.xlim(f_lim)
    plt.ylim([np.min(grupowe)-1, np.max(grupowe)+1])
    
    plt.subplot(2,2,2)
    plt.title('odpowiedź impulsowa')
    plt.plot(t, x)
    plt.plot(t, y)
    plt.xlim([-T/4,T])
    plt.grid('on')
    
    plt.subplot(2,2,4)
    plt.title('odpowiedź schodkowa')
    plt.plot(t, s)
    plt.plot(t, ys)
    plt.xlim([-T/4,T])
    plt.xlabel('Czas [s]')
    plt.grid('on')
    
    fig.subplots_adjust(hspace=.5)
    plt.show()

import warnings
warnings.filterwarnings("ignore")

print('filtr pasmowo-przepustowy Butterwortha rzędu 3, pasmo 11-16 Hz:')
T = 0.8
charkterystyki(a,b,f,T,Fs)

print('filtr dolnoprzepustowy Butterwortha rzędu 3, pasmo odcięcia 10 Hz:')
T = 0.8
charkterystyki(c,d,f,T,Fs)

"""Zastosowany filtr dolnoprzepustowy ma krótką i nieoscylującą odpowiedź impulsową oraz schodkową, natomiast w filtrze pasmowo-przepustowym odpowiedzi te są zdecydowanie dłuższe oraz oscylują. W module transmitancji widzimy, że filtr pasmowo-przepustowy efektywnie tłumi częstości poza pasmem 11-16 Hz, a filtr dolnoprzepustowy efektywnie tłumi wysokie częstości. Połączenie obu filtrów jest optymalne i stało się przydatnym narzędziem w poszukiwaniu wrzecion snu."""